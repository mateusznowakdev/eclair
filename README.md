# EclairM0

[Project description](https://mateusznowak.dev/eclair) and [build instructions](https://mateusznowak.dev/eclair/build) can be found on my website.

Hardware files can be previewed in these third-party web applications:

- KiCad files (board) -- https://kicanvas.org
- OpenSCAD files (enclosure) -- https://openscad.cloud/openscad/

License terms for software and hardware are present in the [LICENSE.md](./LICENSE.md) file.

## Building firmware from source

Install the TinyGo SDK. Copy EclairM0 board definition files as follows:

| File from this repo                | Target SDK directory |
|------------------------------------|----------------------|
| firmware/_board/board_eclair-m0.go | src/machine          |
| firmware/_board/eclair-m0.json     | targets              |
| firmware/_board/eclair-m0.ld       | targets              |

Now you should be able to build and upload new firmware, like this:

```bash
cd firmware
tinygo flash -target eclair-m0 -size short
```

## Updating font data

Font data is stored in the `tools/newstroke.pbm` image file, with `tools/newstroke.txt` containing font widths. The image file can be edited in GIMP.

These source files can be converted into a working Go code, using the `tools/convert.py` script, which should work with any modern version of Python:

```bash
cd tools
python convert.py newstroke.pbm newstroke.txt > ../firmware/hal/display/font.go
```

## 3D-printing the enclosure

Creality Ender-3 V3 KE is my 3D printer. I'm using OrcaSlicer 2.2.0, and at this point I'm too scared to update :)

These are the printing settings recommended by me:

- Global filament settings (PLA) &rarr; 215&deg;C nozzle, 60&deg;C bed
- "0.12mm Fine" base preset
- Quality &rarr; Seam position: BACK
- Quality &rarr; Scarf joint seam: CONTOUR
- Quality &rarr; Elephant foot compensation: 0.15mm (depends on printer calibration, default is 0.05mm)
- Quality &rarr; Precise wall: ON
- Quality &rarr; Walls printing order: INNER/OUTER
- Quality &rarr; Detect overhang walls: OFF
- Strength &rarr; Bottom surface pattern: ARCHIMEDEAN or HILBERT for best appearance
- Speed &rarr; First layer: 20mm/s (default is 50mm/s and it's too fast)

Supports should not be necessary for the bridge under the slide switch cutout.

I'm printing the parts face down, with the USB cutout pointing to the right. Based on the printer calibration, the very center of the heatbed may not give the best results.

## Engraving button labels

Gerber files generated by KiCad can be converted to a G-code compatible with many desktop CNCs. If you happen to use `pcb2gcode`, the example config is available in the repo.
